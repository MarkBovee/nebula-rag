@page "/{*ingressPath:nonfile}"
@rendermode InteractiveServer

<PageTitle>Nebula Management</PageTitle>

<div class="min-h-screen bg-nebula-bg text-nebula-text">
    <div class="mx-auto max-w-7xl px-4 py-6 md:px-8 md:py-10">
        <section class="mb-6 rounded-2xl border border-nebula-border bg-nebula-surface/90 p-6 shadow-xl">
            <div class="flex flex-wrap items-start justify-between gap-4">
                <div>
                    <p class="text-xs uppercase tracking-[0.24em] text-nebula-muted">NebulaRAG</p>
                    <h1 class="mt-1 text-3xl font-semibold md:text-4xl">Management Dashboard</h1>
                    <p class="mt-2 text-sm text-nebula-muted">Operational tabs for RAG, memory, plans, and telemetry.</p>
                </div>
                <button class="rounded-lg border border-nebula-accent px-4 py-2 text-sm font-medium text-nebula-text transition hover:bg-nebula-accent/20" @onclick="RefreshAsync">
                    Refresh
                </button>
            </div>
        </section>

        <section class="mb-6 flex flex-wrap gap-2 rounded-xl border border-nebula-border bg-nebula-surface p-2">
            @foreach (var tab in _tabs)
            {
                <button class="rounded-lg px-4 py-2 text-sm font-medium transition @GetTabClass(tab)" @onclick="() => _activeTab = tab">
                    @tab
                </button>
            }
        </section>

        @if (_activeTab == DashboardTab.Overview)
        {
            <OverviewManagementTab RefreshNonce="@_refreshNonce" />
        }

        @if (_activeTab == DashboardTab.Rag)
        {
            <RagManagementTab RefreshNonce="@_refreshNonce" />
        }

        @if (_activeTab == DashboardTab.Memory)
        {
            <MemoryManagementTab RefreshNonce="@_refreshNonce" />
        }

        @if (_activeTab == DashboardTab.Plans)
        {
            <PlansManagementTab RefreshNonce="@_refreshNonce" />
        }
    </div>
</div>
